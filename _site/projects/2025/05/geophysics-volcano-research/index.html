

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">


<!-- begin SEO -->









<title>Tungurahua Volcano Modeling &amp; Simulation - Paxton Scott</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Paxton Scott ">
<meta property="og:title" content="Tungurahua Volcano Modeling &amp; Simulation">


  <link rel="canonical" href="https://paxtonsc.github.io/projects/2025/05/geophysics-volcano-research/">
  <meta property="og:url" content="https://paxtonsc.github.io/projects/2025/05/geophysics-volcano-research/">



  <meta property="og:description" content="In the fall of 2025, I was living in Seattle, working as a software engineer at SpaceX, and looking for a way to join my girlfriend in Palo Alto. I sent a number of emails to friends, coworkers, and past professors to inquire if they had leads on work that would allow me to work with both physics and software near Palo Alto.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2025-05-21T00:00:00+00:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Paxton Scott",
      "url" : "https://paxtonsc.github.io",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="https://paxtonsc.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Paxton Scott  Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://paxtonsc.github.io/assets/css/main.css">
<meta name="google-site-verification" content="Lkl1K_SpqrsUNXmKvN6VThQ4hHsrZZgAsXGbPFi87HE" />

<meta http-equiv="cleartype" content="on">


  <meta property="og:image" content="https://paxtonsc.github.io/images/favicon.ico>



<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-65XZXJ9G5E"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-65XZXJ9G5E');
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="https://paxtonsc.github.io/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="https://paxtonsc.github.io/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="https://paxtonsc.github.io/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="https://paxtonsc.github.io/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="https://paxtonsc.github.io/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="https://paxtonsc.github.io/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="https://paxtonsc.github.io/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="https://paxtonsc.github.io/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="https://paxtonsc.github.io/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="https://paxtonsc.github.io/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="https://paxtonsc.github.io/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="https://paxtonsc.github.io/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="https://paxtonsc.github.io/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="mask-icon" href="https://paxtonsc.github.io/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="https://paxtonsc.github.io/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="https://paxtonsc.github.io/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="https://paxtonsc.github.io/assets/css/academicons.css"/>


<!-- Support for MatJax -->
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://paxtonsc.github.io/">Paxton Scott </a></li>
          
            
            <li class="masthead__menu-item"><a href="https://paxtonsc.github.io/experience/">Education & Professional Experience</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://paxtonsc.github.io/projects/">Projects</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://paxtonsc.github.io/adventures/">Fun & Hobbies</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://paxtonsc.github.io/resume/">Resume</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    







<div id="main" role="main">
  



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Tungurahua Volcano Modeling &amp; Simulation">
    <meta itemprop="description" content="In the fall of 2025, I was living in Seattle, working as a software engineer at SpaceX, and looking for a way to join my girlfriend in Palo Alto. I sent a number of emails to friends, coworkers, and past professors to inquire if they had leads on work that would allow me to work with both physics and software near Palo Alto.">
    <meta itemprop="datePublished" content="May 21, 2025">
    



    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Tungurahua Volcano Modeling &amp; Simulation
</h1>
          
        
        
        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2025-05-21T00:00:00+00:00">May 21, 2025</time></p>
            
        </header>

      

      <section class="page__content" itemprop="text">
        <p>In the fall of 2025, I was living in Seattle, working as a software engineer at SpaceX, and looking for a way to join my girlfriend in Palo Alto. I sent a number of emails to friends, coworkers, and past professors to inquire if they had leads on work that would allow me to work with both physics and software near Palo Alto.</p>

<p>One of those emails was to Prof. Eric Dunham, and lo and behold he responded:</p>

<blockquote>
  <p>I might have funding for a short term programmer position on a project related to explosive volcanic eruption modeling. I’ll need to check with my research admin when I’m back in the office next week about the project budget and to figure out exactly how I would be able to hire you.</p>
</blockquote>

<p>We worked out the details, and after my last day at SpaceX in December of 2024 I began work with Prof. Dunham in January of 2025. In this writeup, I’ll describe some of the projects I worked on while working with Prof. Dunham and his PhD student Mario.</p>

<ol>
  <li><a href="#intro">Intro</a></li>
  <li><a href="#slip">Slip weakening for plug</a></li>
  <li><a href="#lumped">Lumped parameter model</a></li>
  <li><a href="#atmosphere">Atmosphere coupling</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ol>

<h2 id="00-intro-">0.0 Intro <a name="intro"></a></h2>
<p>Prof. Dunham’s PhD student, Mario, was working to accurately model eruptions of <a href="https://en.wikipedia.org/wiki/Tungurahua">Tungurahua</a>, an active stratovolcano in Ecuador. Mario was working with a modified version of <a href="https://web.stanford.edu/group/ihmegroup/cgi-bin/MatthiasIhme/wp-content/papercite-data/pdf/ching2022quail.pdf">Quail</a>, an open-source PDE solver that one of Prof. Dunham’s previous PhD students, Fred, had already modified to support modeling flow in a quasi-1D volcano conduit.</p>

<h2 id="10-slip-weakening-for-plug-">1.0 Slip weakening for plug <a name="slip"></a></h2>

<h3 id="background">Background</h3>
<p>We were working to model <a href="https://en.wikipedia.org/wiki/Vulcanian_eruption">Vulcanian eruptions</a>. Vulcanian eruptions are typically characterized by a solid plug forming in the conduit of the volcano, pressure building up beneath that plug, and ultimately a short, violent eruption after which a new plug forms in the conduit.</p>

<p>The project I was hired for was to implement a slip-weakening friction law for the volcano plug to the 1D conduit model. Prior to my arrival, the workflow for simulating an eruption was:</p>
<ol>
  <li>Solve the steady state ODEs to arrive at the steady state initial conditions for the eruption.</li>
  <li>Apply those initial conditions to a dynamic model where the plug was effectively removed numerically causing the volcano to erupt.</li>
</ol>

<p>My goal was to integrate the plug expulsion into the numerical model.</p>

<p><img align="left" width="50%" src="/images/2025-05-geophysics/simple_volcano_diagram.png" /></p>

<p>Specifically, I would add a feature to the quail simulation library to apply different friction laws to the solid plug and the liquid melt. For the plug, we apply a slip friction law that is the area where the plug contacts the conduit $\pi R L$ multiplied by $\tau(s(t))$, the wall shear stress where $s(t)$ is ‘slip’ or displacement as a function of time.</p>

<p>Prof. Dunham had previously applied “slip-weakening” <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2006JB004717">with success</a> to earthquake models and thought the mechanism would also be applicable to the volcano plug.</p>

<h3 id="implementation">Implementation</h3>

<p>To implement distinct friction laws for the plug and the melt, it is necessary to know the slip value for a specific position $x$ at a specific time $t$. Tracking slip as a function of position and time allows us to distinguish between the plug and the melt, and also provides an input for the slip weakening friction law.</p>

<p>The <a href="https://github.com/fredriclam/quail_volcano">quail code</a> models the quasi-1D conduit by conserving eight state variables:</p>
<ul>
  <li>$y_a \rho$ - partial density air phase</li>
  <li>$y_{wf} \rho$ - partial density exsolved water</li>
  <li>$y_{cond} \rho$ - partial density condensed phase</li>
  <li>$\rho u_z$ - momentum</li>
  <li>$E$ - energy</li>
  <li>$y_{wt} \rho$ - partial density water, total</li>
  <li>$y_{crys} \rho$ - partial density crystals</li>
  <li>$y_f \rho$ - Fragmented condensed phase</li>
</ul>

<p>Each of these variables is conserved according to various conservation equations. For example, the partial air density is conserved according to the equation:</p>

\[\frac{\partial}{\partial t} (y_a \rho) + \frac{\partial}{\partial z}(y_a \rho u_z) = 0\]

<p>The conservation equation for our new slip variable is:</p>

\[\frac{\partial}{\partial t} \rho s + \frac{\partial}{\partial z} s \rho u = \rho u\]

<p>I matched the implementation of other conserved state variables to add this new variable in this <a href="https://github.com/fredriclam/quail_volcano/commit/3f26ef12649b0b235c5e7d002606f54a50cae46a">PR</a>. With the new variable added, the next step was to implement the slip friction law. I added two variants: both the exponential law above and a linear slip weakening model.</p>

\[\begin{align}
\tau(s) &amp;=
\begin{cases}
\tau_p - (\tau_p - \tau_r)(\frac{s}{D_c}) &amp; s &lt; D_c \\
\tau_r &amp; s \geq D_c \\
\end{cases} \\
\tau(s) &amp;= \tau_r + (\tau_p - \tau_r) \exp{-\frac{s}{D_c}}
\end{align}\]

<p>Where $\tau_p$ and $\tau_r$ are parameters selected based on observational data from past eruptions. Then, I modified the slip friction source term to only apply friction in the “plug” region which could be deduced from our new ‘slip’ state variable. Similarly, I updated the viscous drag source term to only apply in the “melt” region.</p>

<h3 id="validation">Validation</h3>
<p>To show that the slip-weakening force is working as expected, let’s consider a simplified model where the only forces at play are pressure, gravity, slip-weakening friction, and viscous drag. The resulting ODE for the slip of the plug:</p>

\[\begin{align}
M \ddot{s} &amp;= A (p_0 + \Delta p(s)) - p_{atm}A - Mg - 2 \pi R L_p \tau(s) - \frac{8 \mu}{R^2} \dot{s} \\
\end{align}\]

<p>where $p_0$ is the pressure just below the plug and $\mu$ is viscosity. Solving for the steady state–where acceleration ($\ddot{s}$) and velocity ($\dot{s}$) are zero–we get:</p>

\[\begin{align}
0 &amp;= A p_0 - p_{atm}A - M g - 2 \pi R L_p \tau_p \\
p_0 &amp;= p_{atm} + \rho g L_p + \frac{2 L_p \tau_p}{R} 
\end{align}\]

<p>With the specific values from our test problem we get:</p>

\[\begin{align}
p_0 &amp;= 1e5 + \frac{2* 50 [m] * 1e6 [Pa]}{10 [m]} + 2.6e3 [kg/m^3] * 50[m] * 9.8[m/s^2] \\
p_0 &amp;= 11.4e6 \\
\end{align}\]

<p>Further, if we wanted to calculate the expected pressure in steady state at the very bottom of the domain, we could do that with</p>

\[\begin{align}
p_L &amp;= p_0 + \rho g * L_{c} \\
P_L &amp;= 11.4e6 + 2.6e3 [kg/m^3] * 950 [m] * 9.8 [m/s^2] \\
P_L &amp;= 36.6 [Pa]
\end{align}\]

<p>When we run the numerical model with those steady state values as our initial conditions, we see that no slip occurs and the numerical steady state lines up very closely with the analytical results. That suggests that we have correctly implemented the zero velocity case.</p>

<iframe width="100%" height="500px" src="/images/2025-05-geophysics/basic_simulation_with_slip.mp4"></iframe>

<h4 id="stability-analysis">Stability analysis</h4>
<p>In the above example we appear to have a stable equilibrium. One question is: for what value of $D_c$ is the system unstable? That is to say, for what value of $D_c$ is:</p>

\[\frac{|\frac{d F_f}{d s}|}{|\frac{d F_p}{d s}|} &lt; 1\]

<p>Where $F_f$ is the force due friction between the plug and conduit walls and $F_p$ is force due to pressure of the liquid melt. When the condition above is met, that means that the force due to friction decreases more rapidly than the force due to drag decreases. As a result, we would expect that once the system starts slipping it will at least slip until $s = D_c$. The two forces can be expressed as:</p>

\[\begin{align}
F_f(s) &amp;= 2 \pi R\tau(s) \\
F_p(s) &amp;= A(p_0 - \Delta p(s)) \\
\end{align}\]

<p>For our analysis, lets assume a linear slip weakening law and assume that the compressible melt acts according to the law:</p>

\[K = - L \frac{dP}{dL}\]

<p>Where K is the bulk modulus. We are able to write out the derivatives</p>

\[\begin{align}
\frac{d F_P}{ds} &amp;= A * \frac{dP}{ds} = \frac{-A * K}{L_{c}}\\
\frac{d F_f}{ds} &amp;= 2 \pi R L_p \frac{\tau_p - \tau_r}{D_c}
\end{align}\]

<p>The instability condition above is met specifically when</p>

\[\begin{align}
D_c &lt; \frac{L_{c} 2 \pi R L_p (\tau_p - \tau_r)}{A K } \\
D_c &lt; \frac{2 L_{c} L_p (\tau_p - \tau_r)}{R K } \\
\end{align}\]

<p>Plugging in the problems specific to my toy problem I get:</p>

\[\begin{align}
D_c &amp;&lt; \frac{950 [m] * 50 [m] * 1e6 [Pa]}{10 [m] * 1e9 [Pa]} \\
D_c &amp;&lt; 4.7 \\
\end{align}\]

<p>In order to test, this result, I leave the initial conditions the same as the previous problem but I reduce $D_c$ to $3 [m]$. Sure enough that is sufficient to cause a small “eruption”</p>

<iframe width="100%" height="500px" src="/images/2025-05-geophysics/small_controlled_eruption.mp4"></iframe>

<h2 id="20-lumped-parameter-model-">2.0 Lumped parameter model <a name="lumped"></a></h2>

<p>For further verification and understanding, we decided it might be helpful to compare the results generated by Quail to the numerical solution of the ODE:</p>

\[\begin{align}
M_{eff} \ddot{s} &amp;= A (p_0 + \Delta p(s) - p_{atm}) - 2 \pi R L_p \tau(s) - M_{eff} g - 4 \mu L_{c} \dot{s} \\
\ddot{s} &amp;= \frac{A}{M_{eff}}(p_0 - p_{atm} - \frac{Ks}{L_{c}}) - \frac{2 \pi R L_p \tau(s)}{M_{eff}} - g - \frac{4 L_{c} \mu \dot{s}}{M_{eff}}
\end{align}\]

<p>To calculate the viscous drag term, we assume the velocity in the melt increases linearly from zero at the bottom of the conduit to $u_z$ at the top. See my <a href="https://paxtonsc.github.io/files/geophysics/volcano_project/weekly_notes/2025.03.21.experiments.html">weekly notes</a> from March where I discuss this.</p>

<p><img src="/images/2025-05-geophysics/lumped_parameter_model.png" alt="" />
<em>Lumped parameter model compared to Quail for the “slip” eruption simulated in section 1.</em></p>

<p>In addition to verification, we hoped the lumped parameter model would allow us to quickly test out a variety of values of: $\tau_p$, $\tau_r$, $D_c$, $R$, etc. While some of the parameters were bounded by observations–such as the $\tau_p - \tau_r$ and R–a lumped parameter model that we could run quickly would be very helpful to quickly search a large parameter space and compare simulated seismic inversions with validation data from the 2014 eruption. However, as our eruption model grew more complicated with the addition of fragmentation and exsolution, it was sufficiently challenging to develop a simple model that would match the more complex Quail simulation. As a result, we temporarily abandoned the effort in interest of focusing on atmospheric coupling and infrasound data validation.</p>

<h1 id="30-atmosphere-coupling-">3.0 Atmosphere coupling <a name="atmosphere"></a></h1>
<p>Coupled with the seismic sensors around Tungurahua are infrasound sensors that record atmospheric pressure. During the 2014 eruption, these sensors recorded this signal (band-pass filtered between 1 and 20 Hz) at the “HIGH” stations about 2 km from the conduit outlet.</p>

<p><img src="/images/2025-05-geophysics/infrasound_validation.png" alt="" /></p>

<p>Our goal was to couple the atmosphere to our volcano model to create a second source—in addition to seismic data—to validate our model against. I approached the atmospheric modeling problem using three methods, aiming to get comparable results from each method or at least understand any differences in output.</p>

<h2 id="31-quail-atmospheric-model-in-progress">3.1 Quail atmospheric model (in progress)</h2>

<p>Our first concept was to apply the axisymmetric atmospheric model that former PhD student Fred Lam had already implemented in Quail. Two challenges with the Quail implementation are: (1) it is very hard to validate, and (2) adding the atmosphere affects the 1D volcano model in the conduit, which is certainly incorrect. As of this writing, I am still working to better understand what is happening here.</p>

<h2 id="32-simple-monopole-source-model">3.2 Simple monopole source model</h2>

<p>In order to sanity check the output of the Quail atmosphere model, we decided to create a very simple atmosphere model where we assume the source term to be a single monopole at the outlet of the volcano from which pressure could be modeled with the relation:</p>

\[p(r,t) = \frac{\rho \dot{Q}(t-r/c)}{4 \pi} \\\]

<p>where $Q(t) = \dot{s} \pi R^2$ is the volumetric flow in units $[\frac{m^3}{s}]$. The derivation for this relation can be found <a href="https://drive.google.com/file/d/1khrmHWfoOqrcBjE533TtZirvnp9IIAc3/view">here</a>. The code for this simple model is in my <a href="https://paxtonsc.github.io/files/geophysics/volcano_project/weekly_notes/2025.04.28.experiments.html">weekly notes from April</a>.</p>

<iframe width="100%" height="500px" src="/images/2025-05-geophysics/small_controlled_eruption.mp4"></iframe>

<p><em>Monopole source model applied to the simple slip eruption in section 1.</em></p>

<p><img src="/images/2025-05-geophysics/monopole_pressure_vs_time.png" alt="" />
<em>Pressure measured at various distances from the outlet for the above simulation.</em></p>

<h2 id="33-lighthill-stress-tensor-in-progress">3.3 Lighthill Stress Tensor (in progress)</h2>

<p>One challenge with the quail atmosphere model is that the error term is fairly diffusive. One way of getting around the diffusive error is to use the <a href="https://doc.comsol.com/6.1/doc/com.comsol.help.aco/aco_ug_pressure.05.151.html">Lighthill Analogy</a> where Lighthill rearranged the Navier-Stokes equation into an inhomogenous wave equation where the source term only exists in regions of turbulent flow.</p>

\[\begin{align}
\frac{1}{c_0^2}\frac{\partial^2p}{\partial t^2} - \nabla^2 p = \nabla \cdot (\nabla \cdot T) \\
\end{align}\]

<p>The free-space Green’s theorem satisfies the case</p>

\[\begin{align}
\frac{1}{c_0^2}\frac{\partial^2 G}{\partial t^2} - \nabla^2 G = 0
\end{align}\]

<p>where the free-space Green’s theorem for three dimensions is given by</p>

\[\begin{align}
G(x, t; y, \tau) = \frac{\delta( t - \tau - \frac{|x-y|}{c0})}{4 \pi |x - y|}
\end{align}\]

<h3 id="volume-integral-approach">Volume Integral approach</h3>
<p>The simplest approach for calculating pressure with the Lighthill analogy is to integrate over the entire volume of turbulent flow and use that volume integral to predict the acoustic pressure at some distant location $x$.</p>

\[\begin{align}
p'(x,t) &amp;= \int \int_V  G(x, t; y, \tau) \frac{\partial^2 T_{ij}}{\partial y_i \partial y_j}(y, \tau)dy d\tau \\
p'(x,t) &amp;=\frac{1}{4 \pi} \int_V \frac{1}{|x-y|} \frac{\partial^2 T_{ij}}{\partial y_i \partial y_j}(y, t-\frac{|x-y|}{c_0})dy^3 
\end{align}\]

<h4 id="volume-integral-verification">Volume Integral verification:</h4>

<iframe style="margin: 10px;" align="left" width="60%" height="270px" src="/images/2025-05-geophysics/uniform_gaussian_pulse.mp4"></iframe>

<p>To verify that my code for solving the volume integral was indeed behaving as intended, I created a simple test with spatially constant, temporal gaussian substituting the double divergence of the lighthill stress tensor. In this case, because the source term is uniform across the volume $R &lt; 100$ and $Y&gt;0$ and $Y&lt; 100$, we can write the equation for max pressure:</p>

\[p_{max} = \frac{1}{4 \pi} \int_V \frac{1}{|x_{obs} - y|} dy\]

<p>That can roughly be approximated as</p>

\[\begin{align}
p_{max} =&amp; \frac{1}{4 \pi} \frac{V}{r_{avg}} \\
p_{max} =&amp; \frac{1}{4 \pi} \frac{\pi * 100^2 * 200}{2300} \\
p_{max} =&amp; 220 [Pa]
\end{align}\]

<p>And sure enough! When I plot the numerical output from the volume integral at retarded time against the input pulse scaled by $220$, I get matching gaussian curves!</p>

<p><img src="/images/2025-05-geophysics/pressure_verification.png" alt="" /></p>

<p>The next step is to apply the volume integral approach to the double divergence of the lighthill stress tensor. I do that in my notes from the <a href="https://paxtonsc.github.io/files/geophysics/volcano_project/weekly_notes/2025.05.19.experiments.html">week of 2025.05.19</a>. However, because I don’t trust my input, I also don’t trust my output.</p>

<h4 id="surface-integral-approach">Surface Integral approach:</h4>

<p>It is also possible to translate the volume integral as a surface integral.</p>

\[\begin{align}
p'(x,t) = \frac{1}{4\pi} \int_v \frac{1}{|x - y|} \frac{\partial}{\partial y_i} \frac{\partial T_{ij}}{\partial y_j} (y, t - \frac{|x-y|}{c_0}) dy^3
\end{align}\]

<p>Applying the divergence theorem, we can rewrite this volume integral as a surface integral.</p>

\[\begin{align}
p'(x,t) = \frac{1}{4\pi} \int_S \frac{1}{|x - y|}  \frac{\partial T_{ij}}{\partial y_j} (y, t - \frac{|x-y|}{c_0}) \cdot \hat{n} dy^2
\end{align}\]

<p>Let’s integrate over the sphere with a radius $a=100m$. Let’s review a couple aspects of spherical coordinates.</p>

\[\begin{align}
dS =&amp; a^2 \sin \phi d \phi d \theta \\
x =&amp; a \sin \phi \cos \theta \\
y =&amp; a \sin \phi \sin \theta \\
z =&amp; a \cos \phi
\end{align}\]

<p>So we should be able to rewrite the surface integral as follows:</p>

\[p'(x, t) = \frac{1}{4 \pi} \int_0^{\pi/3} \int_0^{2\pi}  \frac{1}{|x - y|} \frac{\partial T_{ij}}{\partial y_j} n_j a^2 \sin \phi d \phi d \theta\]

<h2 id="40-conclusion-">4.0 Conclusion <a name="conclusion"></a></h2>
<p>I have enjoyed working on these various projects related to Mario’s work on accurately simulating the Tungurahua eruption. I will continue to update this page as additional developments occur.</p>


        

        
      </section>

      <footer class="page__meta">
        
        




      </footer>

      

      


  <nav class="pagination">
    
      <a href="https://paxtonsc.github.io/projects/2025/04/adding-comments-to-my-static-website/" class="pagination--pager" title="Adding comments with Staticman to my Jekyll website
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
      

<div class="page__comments">
  
  
    <section id="comments">
      
        <!-- Start static comments -->
        <div class="js-comments">
          
        </div>
        <!-- End static comments -->

        <!-- Start new comment form -->
        <h4 class="page__comments-title">Leave a Comment</h4>
        <p class="small">Your email address will not be published. Required fields are marked <span class="required">*</span></p>
        <form id="comment-form" class="page__comments-form js-form form" method="post" action="https://staticman-comments-e1bj.onrender.com/v2/entry/paxtonsc/paxtonsc.github.io/main">
          <div class="form__spinner">
            <i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>
            <span class="sr-only">Loading...</span>
          </div>

          <fieldset>
            <label for="comment-form-message">Comment <small class="required">*</small></label>
            <textarea type="text" rows="3" id="comment-form-message" name="fields[message]" tabindex="1"></textarea>
            <div class="small help-block"><a href="https://daringfireball.net/projects/markdown/">Markdown is supported.</a></div>
          </fieldset>
          <fieldset>
            <label for="comment-form-name">Name <small class="required">*</small></label>
            <input type="text" id="comment-form-name" name="fields[name]" tabindex="2" />
          </fieldset>
          <fieldset>
            <label for="comment-form-email">Email address <small class="required">*</small></label>
            <input type="email" id="comment-form-email" name="fields[email]" tabindex="3" />
          </fieldset>
          <fieldset class="hidden">
            <input type="hidden" name="options[slug]" value="volcano-modeling">
            <input type="hidden" name="fields[hidden]"/>
          </fieldset>
          <!-- Start comment form alert messaging -->
          <p class="hidden js-notice">
            <strong class="js-notice-text"></strong>
          </p>
          <!-- End comment form alert messaging -->
          <fieldset>
            <button type="submit" id="comment-form-submit" tabindex="5" class="btn btn--large">Submit Comment</button>
          </fieldset>
        </form>
        <!-- End new comment form -->
      
    </section>
  
</div>
    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        

        

<div class="page__footer-copyright">
  &copy; 2025 Paxton Scott, Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.<br />
  Site last updated 2025-08-14
</div>

      </footer>
    </div>

    <script src="https://paxtonsc.github.io/assets/js/main.min.js"></script>
<script src="https://paxtonsc.github.io/assets/js/main.js"></script>








  </body>
</html>

